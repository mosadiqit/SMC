<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="de_partner_ledger_pdf_report">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <div class="oe_structure"/>
                    <div class="text-left">
                    <h3 class="text-center">Partner Ledger </h3>
                    <t t-foreach="request.env['res.partner'].search([('id', '=', data['partner_id'])])" t-as="prd">
                        <strong>Name: </strong><span t-field="prd.name"/><br></br>
                        <strong>Address:</strong><span t-field="prd.street"/>
                    </t>
                        <p><strong>Date: </strong><span t-esc="data['start_date']" t-options="{'widget': 'date'}" />  <strong>- </strong><span t-esc="data['end_date']" t-options="{'widget': 'date'}" /></p>
                    </div>
                </div>
                <table class="table table-sm" name="account_lines_table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Voucher#</th>
<!--                            <th>Account</th>-->
                            <th>Details</th>
                            <th>Debit</th>
                            <th>Credit</th>
                            <th>Balance</th>
                        </tr>
                    </thead>
                    <tbody>

                         <t t-set="rb" t-value="0"/>
                        <tr t-foreach="openbal" t-as="o" style="border-bottom:1px solid #000;">
                               <strong> <td colspan="5" class="text-left" ><strong>Opening Balance</strong></td></strong>
                                <td class="text-right"><strong><span t-esc="o['opening_bal']"/></strong></td>

                            <t t-if="o['opening_bal']">
                            <t t-set="rb" t-value="rb + o['opening_bal']"/>
                            </t>
                        </tr>
                       <tr t-foreach="dat" t-as="d" style="border-bottom:1px solid #001;">
                            <t t-set="rb" t-value="rb + d['debit'] - d['credit'] "/>
                           <td class="text-right"><span t-esc="d['date']" t-options="{'widget': 'date'}" /></td>
                                <td class="text-left"><span t-esc="d['doc_no']"/></td>
<!--                                <td class="text-right"><span t-esc="d['gl_account']"/></td>-->
                                <td class="text-left"><span t-esc="d['line_desc']"/></td>
                               <td class="text-right"><t t-esc="'{0:,.2f}'.format(int(d['debit']))" /></td>
                                <td class="text-right"><t t-esc="'{0:,.2f}'.format(int(d['credit']))" /></td>
                           <td class="text-right"><t t-esc="'{0:,.2f}'.format(int(rb))" /></td>

                        </tr>
                        <tr style="border-top:1px solid #000;">
                                <td colspan="5" class="text-left"><strong>Closing Balance</strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.2f}'.format(int(rb))" /></strong></td>
                        </tr>
                    </tbody>
                  </table>
            </t>
        </t>
    </template>
</odoo>
